<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js">
<script src="https://code.highcharts.com/stock/highcharts.js"></script>
<script src="https://code.highcharts.com/stock/6.1.1/highstock.js"></script>
<script src="https://code.highcharts.com/stock/modules/exporting.js"></script>
<script src="https://code.highcharts.com/stock/modules/export-data.js"></script>
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>

<div id="container" style="height: 300px; width=99% min-width: 310px"></div>
<button type="button" onclick="showCSV()">Show CSV!</button>
<input id="csv" name="csv" type="text" value="data.csv", placeholder="enter CSV file"/></br>
<span id='status'>Status:</span>
<div id="divdata" style="height: 5px; width:100%; display: block;border: 1px solid gray;"></div>

<button type="button" onclick="draw1()">Show CSV!</button></br>
<div id="tables" style="display:inline; overflow:hide;"></div>
<div id="table_div" style="width:250px;background: sky-blue;float:left;border:1px gray solid">Table 1</div>
<div id="table_div1" style="width:250px;background: ;float:left;border:1px gray solid">Tabl2 2</div>
<div id="table_div2" style="width:400px;background: ;float:left;border:1px gray solid">Tabl2 2</div>


<script>
//$.getJSON('https://www.highcharts.com/samples/data/aapl-c.json', function (data) 
function showMarkerChart(data){
    Highcharts.stockChart('container', {
        rangeSelector: {selected: 1 },
        title: { text: 'Anomaly Chart' },
        series: [{
            name: 'AnomalyScore',
            data: data,
            marker: { enabled: true, radius: 3 },
            shadow: true,
            turboThreshold:5000,
            tooltip: { valueDecimals: 2 }
        }]
    });
}
var data="";
function showHC(responseTxt, statusTxt, xhr) {
    if(statusTxt !== "success"){
        $('#status').text("Error Loading File!!!")
    } else {
        $('#status').text(statusTxt)
    }
    console.log('Loaded Data ' + responseTxt)
    console.log('Loaded Data ' + statusTxt)
    ddata = JSON.parse(responseTxt);
    data = ddata[0].values.slice(0,5000)
    showMarkerChart(data)
}

function showCSV() {
    txt = $('#csv').val().trim()
    console.log('showing CSV: ' + txt)
    //$("#divdata").load(txt, showHC)
    //$.getJSON(txt, showHC)
    //$.get(txt, showHC)
    //$.get('http://localhost:5000/data/test/', showHC)
    $.get('http://localhost:5000/q/select time,a,b,c from test/', showHC)
}
</script>
            
<script type="text/javascript">
google.charts.load('current', {'packages':['table']});
//google.charts.setOnLoadCallback(drawTable);

function drawTable(div) {
        var data = new google.visualization.DataTable();
        data.addColumn('string', 'Name');
        data.addColumn('number', 'Salary');
        data.addColumn('boolean', 'Full Time Employee');
        data.addRows([
          ['Mike',  {v: 10000, f: '$10,000'}, true],
          ['Jim',   {v:8000,   f: '$8,000'},  false],
          ['Alice', {v: 12500, f: '$12,500'}, true],
          ['Bob',   {v: 7000,  f: '$7,000'},  true]
        ]);

        var table = new google.visualization.Table(document.getElementById(div));

        table.draw(data, {showRowNumber: true, width: '100%', height: '100%'});
        
      google.visualization.events.addListener(table, 'select', function() {
        var row = table.getSelection()[0].row;
        alert('You selected ' + data.getValue(row, 0));
      });
}
var ddata
function showTable(rdata) {
    console.log("*** Showing Log" + data)
    var data = new google.visualization.DataTable();
    
    ddata = JSON.parse(rdata);
    for (i=0; i < ddata[0].columns.length; i++){
        data.addColumn(typeof(ddata[0].values[0][i]), ddata[0].columns[i]);
        console.log("Adding: ", typeof(ddata[0].columns[i]), ":", ddata[0].columns[i])
    }
    //console.log(ddata)
    data.addRows(ddata[0].values)
    var table = new google.visualization.Table(document.getElementById('table_div2'));
    table.draw(data, {showRowNumber: true, alternatingRowStyle:true, width: '100%', height: '100%', page: 'enable'});
}

function draw1(){
    $.get('http://localhost:5000/q/select time,a,b,c,d,e from test/', showTable)
}

function draw(){
    drawTable('table_div');
    drawTable('table_div1')
}

</script>


<script>
draw()
</script>
